
<html>
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

	<title>Data + Science</title>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<meta name="description" content="Creating Tabitha">
		<meta name="author" content="Jeffrey Shaffer">

		
		
		<script src="https://public.tableausoftware.com/javascripts/api/tableau-2.min.js " type="text/javascript"></script> 

</head>	

<body onload=initializeViz();>
<center><div id='tableauViz'></div></center>

<script>
if (annyang) {
  // These are the voice commands in quotes followed by the function
  var commands = {
  	//commands for Facility_Name
  	'Select Lakeside': function() { selectLakeside(); responsiveVoice.speak('selecting Lakeside', "UK English Female"); },
  	'Select Carehoods': function() { selectCarehoods(); responsiveVoice.speak('selecting Carehoods', "UK English Female"); },
  	'Select Delta center': function() { selectDMC(); responsiveVoice.speak('selecting Delat Medical Center', "UK English Female"); },
     'Select Navato': function() { selectNavato(); responsiveVoice.speak('selecting Navato', "UK English Female"); },
     //commands for Operating Unit
     'Select North': function() { selectNorth(); responsiveVoice.speak('selecting North', "UK English Female"); },
     'Select South': function() { selectSouth(); responsiveVoice.speak('selecting South', "UK English Female"); },
     //commands for Loc_Name
     'Select Northridge': function() { selectNorthridge(); responsiveVoice.speak('selecting Northridge', "UK English Female"); },
     'Select Oakland': function() { selectOakland(); responsiveVoice.speak('selecting Oakland', "UK English Female"); },
     'Select Orange': function() { selectOrange(); responsiveVoice.speak('selecting Orange', "UK English Female"); },
     //Command To reset all the filters
	'start over': function() { startover(); responsiveVoice.speak('starting over'); }

 };
  
  // Add commands to annyang
  annyang.addCommands(commands);
  
  // Start listening. {continuous:false}
  annyang.start();
  annyang.debug();
//	annyang.start({ autoRestart: true });
}
</script>
 
<script>
var viz, workbook, activeSheet, Worksheet, worksheet;
function initializeViz(){

var placeholderDiv = document.getElementById("tableauViz");
var url="https://public.tableau.com/views/Curis_Mammo/Mammo-OU";
//var url = "https://public.tableau.com/views/54SMFJCB6?:toolbar=no&:display_count=yes";
//var url = "https://public.tableau.com/views/CurisDashboard/Compliance_First";
//var url = "https://public.tableau.com/views/CurisDashboard/Mammo_Recall-OU";
//var url = "https://public.tableau.com/views/Superstoretest_5/Testing";
var options = {
   width: "100%",   
   height: "100%",
   hideTabs: true,
   hideToolbar: true,
  onFirstInteractive: function () {
  workbook = viz.getWorkbook();
  activeSheet = workbook.getActiveSheet().getWorksheets().get("Mammo_Recall-OU");
}
};
  viz = new tableauSoftware.Viz(placeholderDiv, url, options);
}

//Tabitha says hello
responsiveVoice.speak('Hi. My name is Ask Curis. How may I help you?');

//Make Faacility Name selection
function selectBates()
	{
	activeSheet.applyFilterAsync("Facility Name","BATES",tableau.FilterUpdateType.REPLACE);
}
function selectNavato()
	{
	activeSheet.applyFilterAsync("Facility Name","NAVATO",tableau.FilterUpdateType.REPLACE);
}

function selectLakeside()
	{
	activeSheet.applyFilterAsync("Facility Name","LAKESIDE",tableau.FilterUpdateType.REPLACE);
}
function selectCarehoods()
	{
	activeSheet.applyFilterAsync("Facility Name","CAREHOODS",tableau.FilterUpdateType.REPLACE);
}
function selectDMC()
	{
	activeSheet.applyFilterAsync("Facility Name","DELTA MEDICAL CENTER",tableau.FilterUpdateType.REPLACE);
}

//Make Operating Unit Selection
function selectNorth()
	{
	activeSheet.applyFilterAsync("Operating Unit","NORTH",tableau.FilterUpdateType.REPLACE);
}
function selectSouth()
	{
	activeSheet.applyFilterAsync("Operating Unit","SOUTH",tableau.FilterUpdateType.REPLACE);
}
//make Loc_Name Selection
function selectNorthridge()
	{
	activeSheet.applyFilterAsync("Loc_Name","Northridge",tableau.FilterUpdateType.REPLACE);
}
function selectOakland()
	{
	activeSheet.applyFilterAsync("Loc_Name","Oakland",tableau.FilterUpdateType.REPLACE);
}
function selectOrange()
	{
	activeSheet.applyFilterAsync("Loc_Name","Orange",tableau.FilterUpdateType.REPLACE);
}
/*function selectNext()
	{
	activeSheet2.getWorksheets()[2].selectMarksAsync('Next', 'Next', 'REPLACE'); 
	}	

*/
	
//Start Viz Over
function startover()
	{
       
	viz.revertAllAsync();
	}

</script>

</body>
</html>		
		
		